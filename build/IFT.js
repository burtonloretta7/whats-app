!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["iframe-transport"]=t():e["iframe-transport"]=t()}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="/",t(0)}([function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n="/iframe.html",a=function r(){var e=this,t=arguments.length<=0||void 0===arguments[0]?"https://iframe.chatid.com":arguments[0];i(this,r),this.create_iframe=function(){e.iframe_loaded=!1,e.iframe=document.createElement("iframe"),e.iframe.src=e.iframe_domain+n,e.iframe.sandbox="allow-scripts allow-same-origin",e.iframe.height=0,e.iframe.width=0,e.iframe.style.visibility="hidden",document.body.appendChild(e.iframe)},this.on=function(t,i){e.cbs[t]=i},this.start_listening=function(){var t=e,i=function(i){var n=i.data;if("loaded"==n.action)t.iframe_loaded=!0;else if(i.origin!==t.iframe_domain)return;n.action in e.cbs&&e.cbs[n.action](n.data)};window.addEventListener?window.addEventListener("message",i,!1):window.attachEvent("onmessage",function(){return i(window.event)})},this.iframe_send=function(t){if(!e.iframe_loaded)throw"not ready";e.iframe.contentWindow.postMessage(t,e.iframe_domain)},this.get=function(){return e.iframe_send({action:"get"})},this.broadcast=function(t){return e.iframe_send({action:"broadcast",data:t})},this.poll=function(){setInterval(function(){return e.iframe_send({action:"poll"})},300)},this.reset=function(){return e.iframe_send({action:"reset"})},this.iframe_domain=t,this.create_iframe(),this.start_listening(),this.cbs={}};t["default"]=a}])});